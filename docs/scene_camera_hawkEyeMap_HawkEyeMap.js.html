<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: scene/camera/hawkEyeMap/HawkEyeMap.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: scene/camera/hawkEyeMap/HawkEyeMap.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import * as Cesium from "cesium";
import "./hawkEyeMap.css";
// @ts-ignore
const Knockout = Cesium.knockout;
class HawkEyeMap {
    constructor(viewer) {
        this.viewModel = {
            enabled: false
        };
        this.viewer = viewer;
        this.hawkEyeMap = null;
        this.bindModel();
    }
    // 初始化函数
    init() {
        this.eye = document.createElement("div");
        this.eye.id = "hawkEyeMap";
        this.eye.classList.add("hawkEye");
        document.body.appendChild(this.eye);
        this.hawkEyeMap = new Cesium.Viewer("hawkEyeMap", {
            geocoder: false,
            homeButton: false,
            sceneModePicker: false,
            baseLayerPicker: false,
            navigationHelpButton: false,
            animation: false,
            timeline: false,
            fullscreenButton: false
        });
        this.hawkEyeMap.cesiumWidget.creditContainer.style.display = "none";
        this.hawkEyeMap.scene.backgroundColor = Cesium.Color.TRANSPARENT;
        this.hawkEyeMap.imageryLayers.removeAll();
        // 鹰眼图中添加高德路网中文注记图
        this.hawkEyeMap.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({
            url: "http://webrd02.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;scale=1&amp;style=8&amp;x={x}&amp;y={y}&amp;z={z}",
            minimumLevel: 3,
            maximumLevel: 18
        }));
        // 引起事件监听的相机变化幅度
        this.viewer.camera.percentageChanged = 0.01;
        this.bindEvent();
    }
    // 绑定事件
    bindEvent() {
        // 监听主图相机变化
        // this.viewer.camera.changed.addEventListener(this.syncMap, this);
        // 第一次刷新渲染时联动（否则第一次鹰眼地图不会联动）
        this.viewer.scene.preRender.addEventListener(this.syncMap, this);
    }
    destroy() {
        let isRemoved1 = this.viewer.scene.preRender.removeEventListener(this.syncMap, this);
        if (isRemoved1) {
            this.hawkEyeMap.destroy();
            this.hawkEyeMap = null;
            this.viewModel.enabled = false;
            this.eye &amp;&amp; document.body.removeChild(this.eye);
        }
        else {
            throw new Error("鹰眼地图销毁失败");
        }
    }
    // 同步主图与鹰眼地图
    syncMap() {
        this.hawkEyeMap.camera.flyTo({
            destination: this.viewer.camera.position,
            orientation: {
                heading: this.viewer.camera.heading,
                pitch: this.viewer.camera.pitch,
                roll: this.viewer.camera.roll
            },
            duration: 0.0
        });
    }
    /**
     * 属性绑定
     */
    bindModel() {
        let _this = this;
        Knockout.track(_this.viewModel);
        Knockout.getObservable(_this.viewModel, "enabled").subscribe((enabled) => {
            if (enabled &amp;&amp; _this.hawkEyeMap == null) {
                _this.init();
            }
            else {
                _this.eye &amp;&amp; (_this.eye.style.display = enabled ? "block" : "none");
            }
        });
    }
}
export default HawkEyeMap;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-viewerCesiumNavigationMixin.html">viewerCesiumNavigationMixin</a></li></ul><h3>Classes</h3><ul><li><a href="AmapImageryProvider.html">AmapImageryProvider</a></li><li><a href="AmapMercatorTilingScheme.html">AmapMercatorTilingScheme</a></li><li><a href="BaiduImageryProvider.html">BaiduImageryProvider</a></li><li><a href="BaiduMercatorTilingScheme.html">BaiduMercatorTilingScheme</a></li><li><a href="Canvas2Image.html">Canvas2Image</a></li><li><a href="CesiumNavigation.html">CesiumNavigation</a></li><li><a href="CesiumZh.html">CesiumZh</a></li><li><a href="ClusterUtil.html">ClusterUtil</a></li><li><a href="CoordTransform.html">CoordTransform</a></li><li><a href="Map.html">Map</a></li><li><a href="NavigationControl.html">NavigationControl</a></li><li><a href="PrimitiveCluster.html">PrimitiveCluster</a></li><li><a href="PublicMethod.html">PublicMethod</a></li><li><a href="ResetViewNavigationControl.html">ResetViewNavigationControl</a></li><li><a href="UserInterfaceControl.html">UserInterfaceControl</a></li><li><a href="ZoomOutNavigationControl.html">ZoomOutNavigationControl</a></li></ul><h3>Global</h3><ul><li><a href="global.html#EARTH_RADIUS">EARTH_RADIUS</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Mon Nov 14 2022 23:16:25 GMT+0800 (中国标准时间)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
